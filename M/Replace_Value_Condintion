// ===== Power Query: Условная замена значений =====
// Заменяет значения в целевом столбце, если выполняется условие в другом столбце
// Автор: [Ваше имя]
// Версия: 1.0

= Table.ReplaceValue(
    #"ПредыдущийШаг",                          // Замените на ваш предыдущий шаг
    each if [Условие_Столбец] = "Условие_Значение" 
        then [Целевой_Столбец] 
        else false,                            // Игнорируем строки, не подходящие под условие
    each "Новое_Значение",                     // Значение для замены
    Replacer.ReplaceValue,                     // Метод замены
    {"Целевой_Столбец"}                        // Столбец, в котором производим замену
)

*/

// ==== ПАРАМЕТРЫ ====
// 1. #"ПредыдущийШаг"       - Результат предыдущего шага в Power Query
// 2. Условие_Столбец        - Столбец, по которому проверяем условие (напр., "Port")
// 3. Условие_Значение       - Значение для сравнения (напр., "9082" или 9082)
// 4. Целевой_Столбец        - Столбец, где заменяем значения (напр., "Conception")
// 5. Новое_Значение         - Значение для подстановки (напр., "Радуга")

// ==== ВАРИАНТЫ ====
// Для числовых условий:      [Условие_Столбец] = 9082
// Для замены null:           then [Целевой_Столбец] (захватывает null)
// Для сложных условий:       then if [Другой_Столбец] = "X" then [Целевой_Столбец] else false
